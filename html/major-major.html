<!doctype HTML>
<meta charset = 'utf-8'>
<html>
  <head>
    <link rel='stylesheet' href='http://timelyportfolio.github.io/rCharts_d3_sankey/css/sankey.css'>
    
    <script src='http://timelyportfolio.github.io/rCharts_d3_sankey/js/d3.v3.js' type='text/javascript'></script>
    <script src='http://timelyportfolio.github.io/rCharts_d3_sankey/js/sankey.js' type='text/javascript'></script>
    
    <style>
    .rChart {
      display: block;
      margin-left: auto; 
      margin-right: auto;
      width: 760px;
      height: 1500px;
    }  
    </style>
    
  </head>
  <body>
    <div id='chart6668576d3947' class='rChart rCharts_d3_sankey'></div>  
    
    <!--Attribution:
Mike Bostock https://github.com/d3/d3-plugins/tree/master/sankey
Mike Bostock http://bost.ocks.org/mike/sankey/
-->

<script>
(function(){
var params = {
 "dom": "chart6668576d3947",
"width":    760,
"height":   1500,
"data": {
 "source": [ "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "ESCUELA NACIONAL DE ARTES PLASTICAS", "ESCUELA NACIONAL DE ARTES PLASTICAS", "ESCUELA NACIONAL DE ARTES PLASTICAS", "ESCUELA NACIONAL DE ENFERMERIA Y OBSTETRICIA", "ESCUELA NACIONAL DE ENFERMERIA Y OBSTETRICIA", "ESCUELA NACIONAL DE MUSICA", "ESCUELA NACIONAL DE MUSICA", "ESCUELA NACIONAL DE MUSICA", "ESCUELA NACIONAL DE MUSICA", "ESCUELA NACIONAL DE MUSICA", "ESCUELA NACIONAL DE MUSICA", "FES ACATLAN", "FES ACATLAN", "FES ACATLAN", "FES ACATLAN", "FES ACATLAN", "FES ACATLAN", "FES ACATLAN", "FES ACATLAN", "FES ACATLAN", "FES ACATLAN", "FES ACATLAN", "FES ACATLAN", "FES ACATLAN", "FES ACATLAN", "FES ACATLAN", "FES ACATLAN", "FES ARAGON", "FES ARAGON", "FES ARAGON", "FES ARAGON", "FES ARAGON", "FES ARAGON", "FES ARAGON", "FES ARAGON", "FES ARAGON", "FES ARAGON", "FES ARAGON", "FES ARAGON", "FES ARAGON", "FES ARAGON", "FES CUAUTITLAN", "FES CUAUTITLAN", "FES CUAUTITLAN", "FES CUAUTITLAN", "FES CUAUTITLAN", "FES CUAUTITLAN", "FES CUAUTITLAN", "FES CUAUTITLAN", "FES CUAUTITLAN", "FES CUAUTITLAN", "FES CUAUTITLAN", "FES CUAUTITLAN", "FES CUAUTITLAN", "FES CUAUTITLAN", "FES CUAUTITLAN", "FES IZTACALA", "FES IZTACALA", "FES IZTACALA", "FES IZTACALA", "FES IZTACALA", "FES IZTACALA", "FES ZARAGOZA", "FES ZARAGOZA", "FES ZARAGOZA", "FES ZARAGOZA", "FES ZARAGOZA", "FES ZARAGOZA", "FES ZARAGOZA", "ACTUARIA", "ACTUARIA", "ADMINISTRACION", "ADMINISTRACION", "ARQUITECTURA", "ARQUITECTURA", "ARQUITECTURA", "ARTES VISUALES", "ARTE Y DISEÑO", "BIBLIOTECOLOGIA Y ESTUDIOS DE LA INFORMACION", "BIOLOGIA", "BIOLOGIA", "BIOLOGIA", "BIOQUIMICA DIAGNOSTICA", "CANTO", "CIENCIAS DE LA COMPUTACION", "CIENCIAS DE LA COMUNICACION", "CIENCIAS DE LA TIERRA", "CIENCIAS POLITICAS Y ADMON PUBLICA", "CIENCIAS POLITICAS Y ADMON PUBLICA", "CIRUJANO DENTISTA", "CIRUJANO DENTISTA", "CIRUJANO DENTISTA", "COMPOSICION", "COMUNICACION", "COMUNICACION Y PERIODISMO", "CONTADURIA", "CONTADURIA", "DERECHO", "DERECHO", "DERECHO", "DESARROLLO Y GESTION INTERCULTURALES", "DISEÑO GRAFICO", "DISEÑO INDUSTRIAL", "DISEÑO Y COMUNICACION VISUAL", "DISEÑO Y COMUNICACION VISUAL", "ECONOMIA", "ECONOMIA", "ECONOMIA", "EDUCACION MUSICAL", "ENFERMERIA", "ENFERMERIA", "ENFERMERIA", "ENFERMERIA Y OBSTETRICIA", "ENSEÑANZA DE INGLES", "ESTUDIOS LATINOAMERICANOS", "ETNOMUSICOLOGIA", "FARMACIA", "FILOSOFIA", "FILOSOFIA", "FISICA", "FISIOTERAPIA", "GEOGRAFIA", "HISTORIA", "HISTORIA", "INFORMATICA", "INGENIERIA AGRICOLA", "INGENIERIA CIVIL", "INGENIERIA CIVIL", "INGENIERIA CIVIL", "INGENIERIA DE MINAS Y METALURGIA", "INGENIERIA ELECTRICA-ELECTRONICA", "INGENIERIA ELECTRICA-ELECTRONICA", "INGENIERIA ELECTRICA Y ELECTRONICA", "INGENIERIA EN ALIMENTOS", "INGENIERIA EN COMPUTACION", "INGENIERIA EN COMPUTACION", "INGENIERIA EN TELECOMUNICACIONES", "INGENIERIA GEOFISICA", "INGENIERIA GEOLOGICA", "INGENIERIA GEOMATICA", "INGENIERIA INDUSTRIAL", "INGENIERIA INDUSTRIAL", "INGENIERIA INDUSTRIAL", "INGENIERIA MECANICA", "INGENIERIA MECANICA", "INGENIERIA MECANICA ELECTRICA", "INGENIERIA MECATRONICA", "INGENIERIA PETROLERA", "INGENIERIA QUIMICA", "INGENIERIA QUIMICA", "INGENIERIA QUIMICA", "INGENIERIA QUIMICA METALURGICA", "ING. EN TELECOMUNICACIONES, SISTEMAS Y ELECTRONICA", "INSTRUMENTISTA", "LENGUA Y LITERATURAS HISPANICAS", "LENGUA Y LITERATURAS HISPANICAS", "LENGUA Y LITERATURAS MODERNAS (LETRAS ALEMANAS)", "LENGUA Y LITERATURAS MODERNAS (LETRAS FRANCESAS)", "LENGUA Y LITERATURAS MODERNAS (LETRAS INGLESAS)", "LENGUA Y LITERATURAS MODERNAS (LETRAS ITALIANAS)", "LENGUA Y LITERATURAS MODERNAS (LETRAS PORTUGUESAS)", "LETRAS CLASICAS", "LITERATURA DRAMATICA Y TEATRO", "MATEMATICAS", "MATEMATICAS APLICADAS Y COMPUTACION", "MEDICINA VETERINARIA Y ZOOTECNIA", "MEDICINA VETERINARIA Y ZOOTECNIA", "MEDICO CIRUJANO", "MEDICO CIRUJANO", "MEDICO CIRUJANO", "OPTOMETRIA", "PEDAGOGIA", "PEDAGOGIA", "PEDAGOGIA", "PIANO", "PLANIF PARA EL DESARROLLO AGROPECUARIO", "PSICOLOGIA", "PSICOLOGIA", "PSICOLOGIA", "QUIMICA", "QUIMICA", "QUIMICA DE ALIMENTOS", "QUIMICA FARMACEUTICO BIOLOGICA", "QUIMICA FARMACEUTICO BIOLOGICA", "QUIMICA INDUSTRIAL", "RELACIONES INTERNACIONALES", "RELACIONES INTERNACIONALES", "RELACIONES INTERNACIONALES", "SOCIOLOGIA", "SOCIOLOGIA", "SOCIOLOGIA", "TRABAJO SOCIAL" ],
"target": [ "ACTUARIA(accepted)", "ADMINISTRACION(accepted)", "ARQUITECTURA(accepted)", "BIBLIOTECOLOGIA Y ESTUDIOS DE LA INFORMACION(accepted)", "BIOLOGIA(accepted)", "CIENCIAS DE LA COMPUTACION(accepted)", "CIENCIAS DE LA COMUNICACION(accepted)", "CIENCIAS DE LA TIERRA(accepted)", "CIENCIAS POLITICAS Y ADMON PUBLICA(accepted)", "CIRUJANO DENTISTA(accepted)", "CONTADURIA(accepted)", "DERECHO(accepted)", "DESARROLLO Y GESTION INTERCULTURALES(accepted)", "ECONOMIA(accepted)", "ESTUDIOS LATINOAMERICANOS(accepted)", "FILOSOFIA(accepted)", "FISICA(accepted)", "FISIOTERAPIA(accepted)", "GEOGRAFIA(accepted)", "HISTORIA(accepted)", "INGENIERIA CIVIL(accepted)", "INGENIERIA DE MINAS Y METALURGIA(accepted)", "INGENIERIA ELECTRICA-ELECTRONICA(accepted)", "INGENIERIA ELECTRICA Y ELECTRONICA(accepted)", "INGENIERIA EN COMPUTACION(accepted)", "INGENIERIA EN TELECOMUNICACIONES(accepted)", "INGENIERIA GEOFISICA(accepted)", "INGENIERIA GEOLOGICA(accepted)", "INGENIERIA GEOMATICA(accepted)", "INGENIERIA INDUSTRIAL(accepted)", "INGENIERIA MECANICA(accepted)", "INGENIERIA MECATRONICA(accepted)", "INGENIERIA PETROLERA(accepted)", "INGENIERIA QUIMICA(accepted)", "INGENIERIA QUIMICA METALURGICA(accepted)", "LENGUA Y LITERATURAS HISPANICAS(accepted)", "LENGUA Y LITERATURAS MODERNAS (LETRAS ALEMANAS)(accepted)", "LENGUA Y LITERATURAS MODERNAS (LETRAS FRANCESAS)(accepted)", "LENGUA Y LITERATURAS MODERNAS (LETRAS INGLESAS)(accepted)", "LENGUA Y LITERATURAS MODERNAS (LETRAS ITALIANAS)(accepted)", "LENGUA Y LITERATURAS MODERNAS (LETRAS PORTUGUESAS)(accepted)", "LETRAS CLASICAS(accepted)", "LITERATURA DRAMATICA Y TEATRO(accepted)", "MATEMATICAS(accepted)", "MEDICINA VETERINARIA Y ZOOTECNIA(accepted)", "MEDICO CIRUJANO(accepted)", "PEDAGOGIA(accepted)", "PSICOLOGIA(accepted)", "QUIMICA(accepted)", "QUIMICA DE ALIMENTOS(accepted)", "QUIMICA FARMACEUTICO BIOLOGICA(accepted)", "RELACIONES INTERNACIONALES(accepted)", "SOCIOLOGIA(accepted)", "TRABAJO SOCIAL(accepted)", "ARTES VISUALES(accepted)", "ARTE Y DISEÑO(accepted)", "DISEÑO Y COMUNICACION VISUAL(accepted)", "ENFERMERIA(accepted)", "ENFERMERIA Y OBSTETRICIA(accepted)", "CANTO(accepted)", "COMPOSICION(accepted)", "EDUCACION MUSICAL(accepted)", "ETNOMUSICOLOGIA(accepted)", "INSTRUMENTISTA(accepted)", "PIANO(accepted)", "ACTUARIA(accepted)", "ARQUITECTURA(accepted)", "CIENCIAS POLITICAS Y ADMON PUBLICA(accepted)", "COMUNICACION(accepted)", "DERECHO(accepted)", "DISEÑO GRAFICO(accepted)", "ECONOMIA(accepted)", "ENSEÑANZA DE INGLES(accepted)", "FILOSOFIA(accepted)", "HISTORIA(accepted)", "INGENIERIA CIVIL(accepted)", "LENGUA Y LITERATURAS HISPANICAS(accepted)", "MATEMATICAS APLICADAS Y COMPUTACION(accepted)", "PEDAGOGIA(accepted)", "RELACIONES INTERNACIONALES(accepted)", "SOCIOLOGIA(accepted)", "ARQUITECTURA(accepted)", "COMUNICACION Y PERIODISMO(accepted)", "DERECHO(accepted)", "DISEÑO INDUSTRIAL(accepted)", "ECONOMIA(accepted)", "INGENIERIA CIVIL(accepted)", "INGENIERIA ELECTRICA-ELECTRONICA(accepted)", "INGENIERIA EN COMPUTACION(accepted)", "INGENIERIA INDUSTRIAL(accepted)", "INGENIERIA MECANICA(accepted)", "PEDAGOGIA(accepted)", "PLANIF PARA EL DESARROLLO AGROPECUARIO(accepted)", "RELACIONES INTERNACIONALES(accepted)", "SOCIOLOGIA(accepted)", "ADMINISTRACION(accepted)", "BIOQUIMICA DIAGNOSTICA(accepted)", "CONTADURIA(accepted)", "DISEÑO Y COMUNICACION VISUAL(accepted)", "FARMACIA(accepted)", "INFORMATICA(accepted)", "INGENIERIA AGRICOLA(accepted)", "INGENIERIA EN ALIMENTOS(accepted)", "INGENIERIA INDUSTRIAL(accepted)", "INGENIERIA MECANICA ELECTRICA(accepted)", "INGENIERIA QUIMICA(accepted)", "ING. EN TELECOMUNICACIONES, SISTEMAS Y ELECTRONICA(accepted)", "MEDICINA VETERINARIA Y ZOOTECNIA(accepted)", "QUIMICA(accepted)", "QUIMICA INDUSTRIAL(accepted)", "BIOLOGIA(accepted)", "CIRUJANO DENTISTA(accepted)", "ENFERMERIA(accepted)", "MEDICO CIRUJANO(accepted)", "OPTOMETRIA(accepted)", "PSICOLOGIA(accepted)", "BIOLOGIA(accepted)", "CIRUJANO DENTISTA(accepted)", "ENFERMERIA(accepted)", "INGENIERIA QUIMICA(accepted)", "MEDICO CIRUJANO(accepted)", "PSICOLOGIA(accepted)", "QUIMICA FARMACEUTICO BIOLOGICA(accepted)", "CU", "FES ACATLAN", "CU", "FES CUAUTITLAN", "CU", "FES ACATLAN", "FES ARAGON", "ESCUELA NACIONAL DE ARTES PLASTICAS", "ESCUELA NACIONAL DE ARTES PLASTICAS", "CU", "CU", "FES IZTACALA", "FES ZARAGOZA", "FES CUAUTITLAN", "ESCUELA NACIONAL DE MUSICA", "CU", "CU", "CU", "CU", "FES ACATLAN", "CU", "FES IZTACALA", "FES ZARAGOZA", "ESCUELA NACIONAL DE MUSICA", "FES ACATLAN", "FES ARAGON", "CU", "FES CUAUTITLAN", "CU", "FES ACATLAN", "FES ARAGON", "CU", "FES ACATLAN", "FES ARAGON", "ESCUELA NACIONAL DE ARTES PLASTICAS", "FES CUAUTITLAN", "CU", "FES ACATLAN", "FES ARAGON", "ESCUELA NACIONAL DE MUSICA", "ESCUELA NACIONAL DE ENFERMERIA Y OBSTETRICIA", "FES IZTACALA", "FES ZARAGOZA", "ESCUELA NACIONAL DE ENFERMERIA Y OBSTETRICIA", "FES ACATLAN", "CU", "ESCUELA NACIONAL DE MUSICA", "FES CUAUTITLAN", "CU", "FES ACATLAN", "CU", "CU", "CU", "CU", "FES ACATLAN", "FES CUAUTITLAN", "FES CUAUTITLAN", "CU", "FES ACATLAN", "FES ARAGON", "CU", "CU", "FES ARAGON", "CU", "FES CUAUTITLAN", "CU", "FES ARAGON", "CU", "CU", "CU", "CU", "CU", "FES ARAGON", "FES CUAUTITLAN", "CU", "FES ARAGON", "FES CUAUTITLAN", "CU", "CU", "CU", "FES CUAUTITLAN", "FES ZARAGOZA", "CU", "FES CUAUTITLAN", "ESCUELA NACIONAL DE MUSICA", "CU", "FES ACATLAN", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "CU", "FES ACATLAN", "CU", "FES CUAUTITLAN", "CU", "FES IZTACALA", "FES ZARAGOZA", "FES IZTACALA", "CU", "FES ACATLAN", "FES ARAGON", "ESCUELA NACIONAL DE MUSICA", "FES ARAGON", "CU", "FES IZTACALA", "FES ZARAGOZA", "CU", "FES CUAUTITLAN", "CU", "CU", "FES ZARAGOZA", "FES CUAUTITLAN", "CU", "FES ACATLAN", "FES ARAGON", "CU", "FES ACATLAN", "FES ARAGON", "CU" ],
"value": [ 237, 936, 769, 147, 300, 41, 262, 51, 152, 348, 1357, 888, 41, 775, 63, 90, 351, 27, 136, 105, 352, 58, 79, 119, 200, 52, 54, 80, 71, 118, 121, 54, 186, 255, 90, 107, 50, 67, 246, 46, 27, 71, 56, 309, 245, 625, 239, 250, 95, 159, 175, 143, 125, 683, 100, 9, 186, 346, 323, 52, 49, 47, 23, 184, 57, 160, 231, 248, 214, 570, 103, 463, 229, 96, 149, 413, 52, 824, 180, 148, 185, 153, 297, 1007, 43, 384, 530, 274, 314, 126, 104, 424, 211, 137, 127, 733, 105, 1023, 66, 131, 395, 136, 492, 92, 567, 189, 194, 399, 122, 123, 233, 357, 369, 311, 122, 392, 190, 242, 458, 524, 98, 281, 152, 3536, 1689, 15059, 4879, 12770, 3475, 3389, 4035, 442, 717, 4258, 2225, 2384, 1835, 171, 1206, 8708, 1109, 3350, 1864, 4728, 5009, 3544, 184, 3674, 5883, 11493, 3550, 16856, 7280, 11457, 804, 6788, 1555, 7497, 3062, 4498, 1689, 1983, 164, 2540, 4849, 6849, 6339, 1085, 455, 66, 606, 1850, 632, 3061, 3132, 852, 1893, 960, 1728, 795, 4222, 2043, 2492, 605, 904, 1382, 1302, 2427, 6345, 4259, 1603, 724, 912, 469, 2704, 1271, 958, 2916, 1428, 2265, 4180, 3028, 2156, 890, 1384, 592, 1721, 398, 1333, 450, 125, 173, 790, 158, 62, 459, 2595, 1913, 2214, 6560, 4177, 31219, 13849, 7369, 1131, 3789, 3605, 5559, 104, 757, 12359, 8430, 9109, 1170, 544, 1968, 4725, 3944, 872, 5567, 3491, 4369, 1463, 908, 1104, 6830 ] 
},
"nodeWidth":     10,
"nodePadding":     10,
"layout":      1,
"units": "persons",
"title": "UNAM",
"id": "chart6668576d3947" 
};

params.units ? units = " " + params.units : units = "";

//hard code these now but eventually make available
var formatNumber = d3.format("0,.0f"),    // zero decimal places
    format = function(d) { return formatNumber(d) + units; },
    color = d3.scale.category20();

if(params.labelFormat){
  formatNumber = d3.format(".2%");
}

var svg = d3.select('#' + params.id).append("svg")
    .attr("width", params.width)
    .attr("height", params.height);
    
var sankey = d3.sankey()
    .nodeWidth(params.nodeWidth)
    .nodePadding(params.nodePadding)
    .layout(params.layout)
    .size([params.width,params.height]);
    
var path = sankey.link();
    
var data = params.data,
    links = [],
    nodes = [];
    
//get all source and target into nodes
//will reduce to unique in the next step
//also get links in object form
data.source.forEach(function (d, i) {
    nodes.push({ "name": data.source[i] });
    nodes.push({ "name": data.target[i] });
    links.push({ "source": data.source[i], "target": data.target[i], "value": +data.value[i] });
}); 

//now get nodes based on links data
//thanks Mike Bostock https://groups.google.com/d/msg/d3-js/pl297cFtIQk/Eso4q_eBu1IJ
//this handy little function returns only the distinct / unique nodes
nodes = d3.keys(d3.nest()
                .key(function (d) { return d.name; })
                .map(nodes));

//it appears d3 with force layout wants a numeric source and target
//so loop through each link replacing the text with its index from node
links.forEach(function (d, i) {
    links[i].source = nodes.indexOf(links[i].source);
    links[i].target = nodes.indexOf(links[i].target);
});

//now loop through each nodes to make nodes an array of objects rather than an array of strings
nodes.forEach(function (d, i) {
    nodes[i] = { "name": d };
});

sankey
  .nodes(nodes)
  .links(links)
  .layout(params.layout);
  
var link = svg.append("g").selectAll(".link")
  .data(links)
.enter().append("path")
  .attr("class", "link")
  .attr("d", path)
  .style("stroke-width", function (d) { return Math.max(1, d.dy); })
  .sort(function (a, b) { return b.dy - a.dy; });

link.append("title")
  .text(function (d) { return d.source.name + " → " + d.target.name + "\n" + format(d.value); });

var node = svg.append("g").selectAll(".node")
  .data(nodes)
.enter().append("g")
  .attr("class", "node")
  .attr("transform", function (d) { return "translate(" + d.x + "," + d.y + ")"; })
.call(d3.behavior.drag()
  .origin(function (d) { return d; })
  .on("dragstart", function () { this.parentNode.appendChild(this); })
  .on("drag", dragmove));

node.append("rect")
  .attr("height", function (d) { return d.dy; })
  .attr("width", sankey.nodeWidth())
  .style("fill", function (d) { return d.color = color(d.name.replace(/ .*/, "")); })
  .style("stroke", function (d) { return d3.rgb(d.color).darker(2); })
.append("title")
  .text(function (d) { return d.name + "\n" + format(d.value); });

node.append("text")
  .attr("x", -6)
  .attr("y", function (d) { return d.dy / 2; })
  .attr("dy", ".35em")
  .attr("text-anchor", "end")
  .attr("transform", null)
  .text(function (d) { return d.name; })
.filter(function (d) { return d.x < params.width / 2; })
  .attr("x", 6 + sankey.nodeWidth())
  .attr("text-anchor", "start");

// the function for moving the nodes
  function dragmove(d) {
    d3.select(this).attr("transform", 
        "translate(" + (
                   d.x = Math.max(0, Math.min(params.width - d.dx, d3.event.x))
                ) + "," + (
                   d.y = Math.max(0, Math.min(params.height - d.dy, d3.event.y))
                ) + ")");
        sankey.relayout();
        link.attr("d", path);
  }
})();
</script>
    
  </body>
</html>
